import{a as E,b as g}from"./accounts.module.CD9CCYs4.js";import{t as y,a as V}from"./transactions.module.B3Vqjk_H.js";import"./notificiation.BI0G4Md-.js";import"./index.BXL97NTB.js";import"./index.CViUNx8d.js";const C=document.getElementById("income-usd"),h=document.getElementById("income-ves"),U=document.getElementById("expense-usd"),b=document.getElementById("expense-ves"),v=document.getElementById("profits-usd"),B=document.getElementById("profits-ves"),D=document.getElementById("income-ves-usd"),I=document.getElementById("expense-ves-usd"),$=document.getElementById("profits-ves-usd"),u=document.getElementById("usd-ves-rate"),f=document.getElementById("usd-ves-text"),S=document.getElementById("update-date"),x=document.getElementById("month-filter"),F=document.getElementById("myChart").getContext("2d");let l;const w=(e,t)=>{let c=0,n=0,o=0,s=0;e.forEach(d=>{const m=t.find(r=>r.id===d.account_id);if(m){const r=Number(d.amount);m.currency==="USD"?d.type==="income"?c+=r:d.type==="expense"&&(n+=r):m.currency==="VES"&&(d.type==="income"?o+=r:d.type==="expense"&&(s+=r))}});const i=c-n,a=o-s;return{incomeUsd:c,expenseUsd:n,profitsUsd:i,incomeVes:o,expenseVes:s,profitsVes:a}},k=(e,t)=>{C.textContent=`$${e.incomeUsd.toFixed(2)} USD`,h.textContent=`Bs.${e.incomeVes.toFixed(2)} VES`,U.textContent=`$${e.expenseUsd.toFixed(2)} USD`,b.textContent=`Bs.${e.expenseVes.toFixed(2)} VES`,v.textContent=`$${e.profitsUsd.toFixed(2)} USD`,B.textContent=`Bs.${e.profitsVes.toFixed(2)} VES`;const c=e.incomeVes/t,n=e.expenseVes/t,o=e.profitsVes/t;D.textContent=`${c.toFixed(2)}`,I.textContent=`${n.toFixed(2)}`,$.textContent=`${o.toFixed(2)}`,u.textContent=`Bs.${t.toFixed(2)}`,f.textContent=`${t.toFixed(2)}`;const s=new Date;S.textContent=s.toLocaleDateString("es-ES",{day:"numeric",month:"long",year:"numeric"}),l&&l.destroy();const a={type:"bar",data:{labels:["income","expense","profits"],datasets:[{label:"Resumen (USD)",data:[e.incomeUsd,e.expenseUsd,e.profitsUsd],backgroundColor:["#4f39f6","#c70036","#00bba7"],borderColor:["#4f39f6","#c70036","#00bba7"],borderWidth:1},{label:"Resumen (VES)",data:[e.incomeVes,e.expenseVes,e.profitsVes],backgroundColor:["#8e7bff","#ff6384","#66d9d0"],borderColor:["#8e7bff","#ff6384","#66d9d0"],borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{x:{stacked:!0},y:{stacked:!0,beginAtZero:!0}},plugins:{legend:{position:"top"},title:{display:!0,text:"ComparaciÃ³n de income, expense y profits"}}}};l=new Chart(F,a)},p=(e,t,c)=>{const n=x.value;let o=e;n!=="all"&&(o=e.filter(i=>(new Date(i.date).getMonth()+1).toString().padStart(2,"0")===n));const s=w(o,t);k(s,c)},A=async()=>{try{await E.getAccount(),await y.getTransaction();const t=await fetch("https://ve.dolarapi.com/v1/dolares/oficial");if(!t.ok)throw new Error(`Error de red: ${t.status}`);const n=(await t.json()).promedio,o=V.get(),s=g.get();p(o,s,n),x.addEventListener("change",()=>{p(o,s,n)})}catch(e){console.error("Could not get the dollar value:",e),u.textContent="Error",f.textContent="N/A"}};A();
